{% extends 'base.html' %}
{% block content %}
<h1>회사 관리</h1>

<div class="card">
  <h2>신규 회사 추가</h2>
  <form method="post" action="{{ url_for('admin.company_new') }}" class="form">
    <input type="hidden" name="csrf_token" value="{{ csrf_token() }}">
    <label>회사명<input type="text" name="name" placeholder="예: ㈜아이템" required></label>
    <label>슬러그<input type="text" name="slug" placeholder="예: acme" required></label>
    <button type="submit" class="primary">추가</button>
  </form>
  <p class="hint">생성 시 회사 전용 접속코드가 1회 표시됩니다.</p>
  </div>

<div class="card">
  <h2>등록된 회사</h2>
  <div class="table-wrap">
  <table class="table">
    <thead>
      <tr>
        <th>회사명</th>
        <th>슬러그</th>
        <th>생성일</th>
        <th>관리</th>
      </tr>
    </thead>
    <tbody>
      {% for c in companies %}
      <tr>
        <td>{{ c.name }}</td>
        <td>{{ c.slug }}</td>
        <td>{{ c.created_at.strftime('%Y-%m-%d %H:%M') }}</td>
        <td>
          <a href="{{ url_for('admin.company_detail', company_id=c.id) }}">보기</a>
          ·
          <a href="{{ url_for('admin.company_impersonate', company_id=c.id) }}">포털</a>
        </td>
      </tr>
      {% else %}
      <tr><td colspan="4">등록된 회사가 없습니다.</td></tr>
      {% endfor %}
    </tbody>
  </table>
  </div>
</div>

<div class="card" style="margin-top:12px;">
  <h2>세금 · 간이세액표</h2>
  <p class="muted">국세청 간이세액표(연도별)를 업로드하고 샘플 조회로 검증할 수 있습니다.</p>
  <div style="display:flex; justify-content:flex-end;">
    <a class="btn" href="{{ url_for('admin.withholding_index') }}">간이세액표 관리 이동</a>
  </div>
  {% if wh_counts %}
  <ul style="margin-top:8px;">
    {% for info in wh_counts %}
      <li>{{ info.year }}년: {{ info.count }}건</li>
    {% endfor %}
  </ul>
  {% endif %}
</div>
{% endblock %}
