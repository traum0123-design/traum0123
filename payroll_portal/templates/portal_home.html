{% extends 'base.html' %}
{% block content %}
<div class="center" style="max-width:960px;">
  <div class="kicker">PAYROLL</div>
  <h1>{{ company_name }} · 월 선택</h1>

  <div class="card" style="margin-bottom:14px; display:flex; align-items:center; gap:10px; justify-content:center;">
    <button class="btn" onclick="changeYear(-1)">◀</button>
    <strong style="font-size:20px; min-width:120px; text-align:center">{{ year }}년</strong>
    <button class="btn" onclick="changeYear(1)">▶</button>
  </div>

  <div class="card" style="padding:16px;">
    <input type="hidden" id="currentYear" value="{{ year }}">
    <div class="grid-months">
      {% for m in months %}
      <a class="month-btn {{ m.state }}{% if m.is_current %} current{% endif %}"
         href="{{ url_for('portal.edit_payroll', slug=slug, year=year, month=m.month) }}">
        <div class="m">{{ '%02d'|format(m.month) }}월</div>
        <div class="s">
          {% if m.state == 'done' %}
            완료
          {% elif m.state == 'empty' %}
            저장됨(내용없음)
          {% else %}
            미입력
          {% endif %}
        </div>
        <div class="u">{{ m.updated_at }}</div>
      </a>
      {% endfor %}
    </div>
    <div class="legend">
      <span class="badge b-done">완료</span>
      <span class="badge b-empty">저장됨(내용없음)</span>
      <span class="badge b-none">미입력</span>
      <span class="badge b-current">현재월</span>
    </div>
  </div>
</div>

<style>
  .grid-months{ display:grid; grid-template-columns: repeat(4, 1fr); gap:12px; }
  @media (max-width: 720px){ .grid-months{ grid-template-columns: repeat(3, 1fr); } }
  .month-btn{ display:block; border:1px solid var(--border); border-radius:12px; padding:14px; text-decoration:none; color:inherit; transition:all .15s ease; }
  .month-btn:hover{ box-shadow:var(--shadow); transform: translateY(-1px); }
  .month-btn .m{ font-weight:700; font-size:18px; }
  .month-btn .s{ font-size:12px; opacity:.85; }
  .month-btn .u{ font-size:11px; opacity:.6; margin-top:4px; }
  .month-btn.done{ background:#ecfdf5; border-color:#10b98155; }
  .month-btn.empty{ background:#f8fafc; border-color:#94a3b844; }
  .month-btn.none{ background:#fff; }
  .month-btn.current{ outline:2px solid #2563eb; }
  .legend{ display:flex; gap:8px; margin-top:12px; flex-wrap:wrap; }
  .badge{ display:inline-block; padding:4px 8px; border-radius:999px; font-size:12px; border:1px solid var(--border); }
  .badge.b-done{ background:#ecfdf5; border-color:#10b98155; }
  .badge.b-empty{ background:#f8fafc; border-color:#94a3b844; }
  .badge.b-none{ background:#fff; }
  .badge.b-current{ background:#e0edff; border-color:#2563eb55; }
</style>

<script nonce="{{ csp_nonce() }}" src="{{ url_for('static', filename='portal_home.js') }}"></script>
{% endblock %}
