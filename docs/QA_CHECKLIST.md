## 포털/관리자 수동 QA 체크리스트 (초안)

### 사전 준비
- `uvicorn app.main:app --reload` 등으로 애플리케이션 기동
- 테스트용 `ADMIN_PASSWORD`, 회사 데이터, 원천징수 표 세팅 확인

### 1. 관리자 흐름
1. `/admin/login` 접속 → 올바른 비밀번호로 로그인 → HttpOnly `admin_token` 쿠키 생성 확인
2. 잘못된 비밀번호 시도 → 403 응답과 “invalid password” 메시지 확인
3. `/admin/` 대시보드에서 회사 목록 표시 확인 (없으면 빈 리스트)
4. `새 회사 생성` 폼 제출 → 성공 후 접속코드 노출 & 목록에 신규 회사 표시
5. 동일 슬러그 재생성 시도 → 400 `slug in use` 오류 확인
6. 회사 상세 페이지에서 `접속코드 재발급` → 새 코드를 받아 로그인 가능 여부 확인
7. `모의 로그인`(impersonate) 실행 → 포털로 리다이렉트 및 `portal_token` 쿠키 발급 확인
8. `/admin/tax/withholding/import` 호출 → 정상 Import / 오류 입력 시 400 응답

### 2. 포털 흐름
1. `/portal/{slug}/login` 접근 → 유효/무효 접속코드 각각 입력 → 성공 시 홈으로 이동, 실패 시 오류 메시지
2. 홈 화면에서 연도별 월 상태 표 확인, 현재 월 강조 여부 검증
3. 월 클릭 시 편집 페이지로 이동 → 기본 컬럼/엑스트라 필드 렌더링
4. 행 추가 후 저장 → 성공 응답(`ok: true`)과 “저장되었습니다” 플래시 메시지 확인
5. 저장 후 새로고침 → 입력 데이터 유지
6. “엑셀 올리기” / 붙여넣기 기능(있는 경우) 정상 동작 여부 확인
7. “엑셀 다운로드” 클릭 → 파일 다운로드 및 헤더(수당/공제) 구조 확인
8. 관리자 impersonate 로 진입 시 마감 버튼 표시/작동 (`/close`, `/open`)
9. 마감 상태에서 수정/저장 시도 → 400 `month is closed` 응답 확인
10. 로그아웃 시 쿠키 제거 및 로그인 페이지로 리다이렉트 확인

### 3. 공통/기타
1. 인증 없이 `/api/portal/...` 호출 → 403 `missing token` 응답
2. 잘못된 토큰 → 403 `invalid token`, 존재하지 않는 slug → 404
3. `/client-log` 엔드포인트: 토큰 없이 호출 시 403, 관리자/회사 토큰으로 호출 시 200
4. `/docs` OpenAPI 문서에서 주요 라우트 스키마 확인
5. 에러 응답이 `{"ok": false, "error": "...", "code": "..."}` 형식인지 확인

### 확인 후 정리
- 이상 행동/메시지 발견 시 재현 단계 기록
- 필요 시 `tests/` 내 단위 테스트 보강 포인트 메모

